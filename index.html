<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Official IQ Test 2026 | Calculate Your Intelligence Quotient</title>
    
    <meta name="description" content="Take the official IQ Test based on Raven's Matrices. Instant results, fluid intelligence analysis, and downloadable PDF certificate. Start now (20 min).">
    
    <meta property="og:title" content="How smart are you? Take the Official IQ Test.">
    <meta property="og:description" content="Measure your logic and fluid intelligence with the 2026 standardized assessment.">
    <meta property="og:image" content="https://test.reav.space/social-preview.jpg"> <meta property="og:url" content="https://test.reav.space">
    <meta property="og:type" content="website">
    
    <link rel="canonical" href="https://test.reav.space/" />
	
    <script src="https://www.paypal.com/sdk/js?client-id=AWsLSgZRVeueciwYeLNRDZF4ZOFu5WTo9hzW-nQPdI4G2EtD6012XYLUZsPDZwI4yZIvQL_lA9uhItAW&currency=EUR"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
	<link rel="icon" href="data:image/svg+xml,%3Csvg%20width%3D%22512%22%20height%3D%22512%22%20viewBox%3D%220%200%2024%2024%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Crect%20x%3D%220%22%20y%3D%220%22%20width%3D%2224%22%20height%3D%2224%22%20rx%3D%225%22%20fill%3D%22%232563eb%22%2F%3E%3Cg%20transform%3D%22scale(0.8)%20translate(3%2C%203)%22%3E%3Cpath%20d%3D%22M12%207L7%2017M12%207L17%2017M7%2017H17%22%20stroke%3D%22white%22%20stroke-width%3D%222%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%2F%3E%3Ccircle%20cx%3D%2212%22%20cy%3D%227%22%20r%3D%222.5%22%20fill%3D%22white%22%2F%3E%3Ccircle%20cx%3D%227%22%20cy%3D%2217%22%20r%3D%222.5%22%20fill%3D%22white%22%2F%3E%3Ccircle%20cx%3D%2217%22%20cy%3D%2217%22%20r%3D%222.5%22%20fill%3D%22white%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E">
    
	<script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Quiz",
      "name": "Global Cognitive Assessment 2026",
      "description": "Standardized test for measuring fluid intelligence and IQ based on Raven's Matrices.",
      "educationalLevel": "Intermediate",
      "assesses": "Logical Reasoning",
      "hasPart": {
        "@type": "Question",
        "name": "Logic Pattern Example",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Pattern recognition and matrix completion"
        }
      }
    }
    </script>
	
	<style>
        :root {
            --primary: #0f172a; /* Navy Dark */
            --accent: #3b82f6;  /* Blue Bright */
            --bg: #f8fafc;
            --shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.15);
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg);
            color: var(--primary);
            margin: 0;
            padding: 20px 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        /* HEADER */
		header {
			width: 100%;
			background: rgba(255, 255, 255, 0.95); /* Leggermente trasparente */
			backdrop-filter: blur(10px); /* Effetto vetro sfocato */
			padding: 15px 0;
			box-shadow: 0 4px 20px rgba(0,0,0,0.04); /* Ombra molto morbida */
			display: flex;
			justify-content: center;
			align-items: center;
			position: sticky; /* Rimane fisso in alto */
			top: 0;
			z-index: 1000;
			border-bottom: 1px solid rgba(0,0,0,0.05);
		}

		.header-content {
			width: 90%;
			max-width: 800px;
			display: flex;
			justify-content: space-between;
			align-items: center;
		}

		/* Contenitore Logo + Testo */
		.brand-container {
			display: flex;
			align-items: center;
			gap: 12px;
			cursor: default;
		}

		/* L'icona SVG del cervello/neuroni */
		.brand-icon {
			width: 42px;
			height: 42px;
			/* Colore esatto del PDF (Royal Blue) */
			background-color: #2563eb; 
			border-radius: 10px;
			display: flex;
			align-items: center;
			justify-content: center;
			/* Ombra pi√π coerente col blu */
			box-shadow: 0 4px 10px rgba(37, 99, 235, 0.3);
		}

		.brand-icon svg {
			width: 24px;
			height: 24px;
			/* Rimuovi fill: white perch√© useremo stroke/fill specifici nell'SVG */
		}

		/* Testo del logo */
		.brand-text {
			display: flex;
			flex-direction: column;
			line-height: 1.1;
		}

		.brand-name {
			font-family: 'Inter', sans-serif;
			font-weight: 800;
			font-size: 1.25rem;
			color: var(--primary);
			letter-spacing: -0.5px;
		}

		.brand-subtitle {
			font-family: 'Inter', sans-serif;
			font-size: 0.65rem;
			text-transform: uppercase;
			letter-spacing: 1.5px;
			color: #64748b;
			font-weight: 600;
		}

		/* Timer migliorato */
		#timer-badge {
			background-color: #fff1f2;
			color: #be123c;
			font-weight: 700;
			padding: 8px 16px;
			border-radius: 30px;
			font-size: 0.95rem;
			border: 1px solid #fecdd3;
			display: none; /* Gestito da JS */
			box-shadow: 0 2px 5px rgba(190, 18, 60, 0.1);
			font-variant-numeric: tabular-nums; /* Evita che i numeri saltino */
		}

        /* CARDS */
        .card {
            background: white;
            width: 90%;
            max-width: 700px;
            padding: 50px;
            border-radius: 20px;
            box-shadow: var(--shadow);
            text-align: center;
            transition: all 0.3s ease;
            box-sizing: border-box;
        }

        .hidden { display: none !important; }

        h1 { font-size: 2.2rem; letter-spacing: -1px; margin-bottom: 10px; }
        h2 { font-size: 1.8rem; margin-bottom: 20px; }
        p { line-height: 1.6; color: #475569; font-size: 1.05rem; }

        /* BUTTONS */
        .btn {
            background-color: var(--primary);
            color: white;
            padding: 16px 40px;
            border: none;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 8px;
            transition: transform 0.1s, opacity 0.2s;
            margin-top: 20px;
            width: 100%;
            max-width: 300px;
        }
        .btn:hover { opacity: 0.9; transform: translateY(-2px); }

        /* PROGRESS BAR */
        .progress-track {
            width: 100%;
            height: 6px;
            background-color: #e2e8f0;
            border-radius: 3px;
            margin-bottom: 40px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            width: 0%;
            background-color: var(--accent);
            transition: width 0.4s ease;
        }

        /* OPTIONS */
        .options-grid {
            display: grid;
            gap: 15px;
            margin-top: 40px;
        }
        
        #question-text svg {
			width: 100%;
			max-width: 380px; /* Ridotto da 500px a 380px */
			height: auto;
			margin-bottom: 25px;
			filter: drop-shadow(0 4px 6px rgba(0,0,0,0.1));
		}

		/* Card delle Risposte */
		.option-card {
			background: white;
			border: 2px solid #e2e8f0;
			padding: 10px; 
			border-radius: 12px;
			cursor: pointer;
			text-align: center;
			transition: all 0.2s;
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
			min-height: 110px; /* Ridotto da 140px */
		}

		.option-card:hover {
			border-color: var(--accent);
			background-color: #eff6ff;
			transform: translateY(-3px);
			box-shadow: 0 5px 15px rgba(59, 130, 246, 0.15);
		}
		
		.option-svg-container svg {
			width: 65px;  /* Ridotto da 90px a 65px */
			height: 65px;
			display: block;
			margin: 0 auto;
		}

        /* RESULTS BLUR */
        .result-blur-wrapper {
            position: relative;
            margin: 30px 0;
            padding: 30px;
            border: 1px solid #e2e8f0;
            border-radius: 16px;
            overflow: hidden;
        }
        
        .blurred-content {
            filter: blur(12px);
            opacity: 0.5;
            user-select: none;
            pointer-events: none;
        }

		/* Stile specifico per l'SVG dentro le risposte */
		.option-svg {
			width: 80px;  /* Dimensione fissa per le risposte */
			height: 80px;
			margin-bottom: 10px;
		}

		/* L'etichetta A, B, C, D... */
		.option-label {
			font-weight: 800;
			color: #64748b;
			font-size: 1rem; /* Leggermente pi√π piccolo */
			margin-top: 8px;
			border-top: 1px solid #eee;
			width: 100%;
			padding-top: 4px;
		}

        .paywall-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255,255,255,0.4);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10;
        }

        .lock-icon { font-size: 3rem; margin-bottom: 15px; color: var(--primary); }

        /* BADGES */
        .iq-badge-large {
            font-size: 5rem;
            font-weight: 800;
            color: var(--accent);
            line-height: 1;
            margin: 20px 0;
        }

        .category-score {
            display: flex;
            justify-content: space-between;
            border-bottom: 1px solid #e2e8f0;
            padding: 10px 0;
            margin-bottom: 10px;
        }

        /* ADMIN BTN */
        .admin-btn {
            background: transparent;
            color: #ccc;
            border: 1px solid #eee;
            margin-top: 40px;
            padding: 5px 10px;
            font-size: 0.7rem;
            cursor: pointer;
        }
        .admin-btn:hover { color: #333; border-color: #333; }
		/* NUOVI STILI LANDING PAGE */
		.hero-badge {
			background: #eff6ff;
			color: var(--primary);
			font-size: 0.8rem;
			font-weight: 700;
			padding: 6px 12px;
			border-radius: 30px;
			text-transform: uppercase;
			letter-spacing: 1px;
			display: inline-block;
			margin-bottom: 15px;
			border: 1px solid #dbeafe;
		}

		.features-grid {
			display: grid;
			grid-template-columns: repeat(3, 1fr);
			gap: 20px;
			margin: 30px 0;
			text-align: left;
		}

		.feature-item {
			padding: 15px;
			background: #f8fafc;
			border-radius: 10px;
			border: 1px solid #e2e8f0;
		}

		.feature-icon {
			font-size: 1.5rem;
			margin-bottom: 10px;
			display: block;
		}

		.feature-title {
			font-weight: 700;
			font-size: 0.9rem;
			color: var(--primary);
			margin-bottom: 5px;
			display: block;
		}

		.feature-desc {
			font-size: 0.8rem;
			color: #64748b;
			line-height: 1.4;
		}

		.scientific-box {
			background: #fff;
			border-left: 4px solid var(--accent);
			padding: 20px;
			text-align: left;
			margin: 30px 0;
			box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
		}

		.checklist {
			list-style: none;
			padding: 0;
			text-align: left;
			margin: 20px 0;
			display: inline-block;
		}

		.checklist li {
			margin-bottom: 10px;
			display: flex;
			align-items: center;
			color: #475569;
			font-size: 0.95rem;
		}

		.checklist li::before {
			content: "‚úì";
			color: var(--accent);
			font-weight: bold;
			margin-right: 10px;
		}
		
		.options-grid {
			display: grid;
			/* Crea colonne automatiche: su PC ne mette 2, su mobile 1 */
			grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); 
			gap: 15px;
			margin-top: 40px;
		}
		
		.question-img {
			max-width: 100%;
			height: auto;
			border-radius: 8px;
			border: 1px solid #e2e8f0;
			margin-bottom: 20px;
			box-shadow: 0 4px 6px rgba(0,0,0,0.05);
		}

		.footer-legal {
			font-size: 0.75rem; 
			color: #94a3b8; 
			margin-top: auto; /* Spinge il footer in fondo alla pagina */
			padding: 20px 0;
			width: 100%;
			text-align: center;
		}

		.footer-legal a {
			color: inherit;
			text-decoration: none;
			margin: 0 5px;
		}

		.footer-legal a:hover {
			text-decoration: underline;
			color: var(--primary);
		}
		
		/* --- PREMIUM LOCK CARD --- */
		.premium-blur-container {
			position: relative;
			background: white;
			border-radius: 16px;
			box-shadow: 0 10px 40px -10px rgba(0,0,0,0.1);
			overflow: hidden;
			margin: 20px 0;
			border: 1px solid #e2e8f0;
		}

		/* Lo sfondo sfocato che sembra il report vero */
		.fake-report-bg {
			padding: 30px;
			filter: blur(6px);
			opacity: 0.6;
			pointer-events: none;
			user-select: none;
			transform: scale(1.02); /* Evita bordi bianchi col blur */
		}

		/* L'overlay che "vende" il prodotto */
		.premium-overlay {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background: rgba(255, 255, 255, 0.6); /* Semi-trasparente */
			backdrop-filter: blur(4px); /* Blur aggiuntivo */
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
			z-index: 10;
		}

		.lock-badge {
			width: 60px;
			height: 60px;
			background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); /* Gold Gradient */
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: 1.8rem;
			box-shadow: 0 10px 20px rgba(245, 158, 11, 0.3);
			margin-bottom: 15px;
			color: white;
		}

		.premium-title {
			font-size: 1.4rem;
			font-weight: 800;
			color: var(--primary);
			margin-bottom: 5px;
		}

		.premium-subtitle {
			font-size: 0.95rem;
			color: #64748b;
			margin-bottom: 20px;
		}

		/* Lista dei benefici con spunte verdi */
		.benefit-list {
			text-align: left;
			background: white;
			padding: 20px;
			border-radius: 12px;
			box-shadow: 0 4px 15px rgba(0,0,0,0.05);
			margin-bottom: 20px;
			border: 1px solid #f1f5f9;
		}

		.benefit-item {
			display: flex;
			align-items: center;
			font-size: 0.9rem;
			color: #334155;
			margin-bottom: 8px;
			font-weight: 500;
		}

		.benefit-item svg {
			width: 18px;
			height: 18px;
			fill: #10b981; /* Green */
			margin-right: 10px;
			flex-shrink: 0;
		}

		/* Range Box migliorato */
		.range-box-premium {
			background: linear-gradient(to right, #eff6ff, #f8fafc);
			border: 1px solid #dbeafe;
			padding: 20px;
			border-radius: 12px;
			margin-bottom: 25px;
			margin-top: 10px;
		}

		/* Responsivit√† per cellulari */
		@media (max-width: 600px) {
			.features-grid { grid-template-columns: 1fr; }
			.card { padding: 25px; }
		}
    </style>
</head>
<body>

    <header>
		<div class="header-content">
			<div class="brand-container">
				<div class="brand-icon">
					<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<path d="M12 7L7 17M12 7L17 17M7 17H17" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
						<circle cx="12" cy="7" r="2.5" fill="white"/>
						<circle cx="7" cy="17" r="2.5" fill="white"/>
						<circle cx="17" cy="17" r="2.5" fill="white"/>
					</svg>
				</div>
				
				<div class="brand-text">
					<span class="brand-name">IQ METRICS <span style="font-weight:400; color:#64748b;">GLOBAL</span></span>
					<span class="brand-subtitle">Certified Assessment</span>
				</div>
			</div>

			<div id="timer-badge">20:00</div>
		</div>
	</header>

    <div id="intro" class="card">
		<div class="hero-badge">Standardized 2026 Edition</div>
		
		<h1>Global Cognitive Assessment</h1>
		<p style="font-size: 1.1rem; max-width: 600px; margin: 0 auto; color: #475569;">
			This professional instrument utilizes the <strong>Raven's Progressive Matrices</strong> methodology to evaluate General Cognitive Ability (<em>g-factor</em>) across three distinct domains.
		</p>

		<div class="features-grid">
			<div class="feature-item">
				<span class="feature-icon">üß†</span>
				<span class="feature-title">Fluid Intelligence</span>
				<div class="feature-desc">Ability to solve novel problems and identify patterns independent of learned knowledge.</div>
			</div>
			<div class="feature-item">
				<span class="feature-icon">üìê</span>
				<span class="feature-title">Spatial Reasoning</span>
				<div class="feature-desc">Capacity to visualize and manipulate complex shapes and sequences mentally.</div>
			</div>
			<div class="feature-item">
				<span class="feature-icon">üî¢</span>
				<span class="feature-title">Numerical Logic</span>
				<div class="feature-desc">Aptitude for analyzing quantitative data and identifying mathematical relationships.</div>
			</div>
		</div>

		<div class="scientific-box">
			<h4 style="margin-top:0; color:var(--primary);">Assessment Protocol</h4>
			<p style="font-size: 0.9rem; margin-bottom: 0;">
				The test consists of <strong>30 adaptive questions</strong> with increasing difficulty. 
				The final score is normalized against a global sample population (Mean=100, SD=15).
				<br><br>
				<strong>Validity:</strong> Results from this assessment are statistically correlated with professional WAIS-IV standards.
			</p>
		</div>

		<div style="text-align: center;">
			<p style="font-weight: 600; font-size: 0.9rem; text-transform: uppercase; color: #94a3b8; letter-spacing: 1px;">Before you begin</p>
			<ul class="checklist">
				<li>Ensure you have <strong>20 minutes</strong> of uninterrupted time.</li>
				<li>Do not use calculators or external search tools.</li>
				<li>Find a quiet environment to maximize focus.</li>
			</ul>
		</div>

		<button class="btn" onclick="startTest()">Begin Certified Test</button>
		
		<div style="margin-top: 20px; font-size: 0.75rem; color: #cbd5e1;">
			ID: #REQ-2026-GCA ‚Ä¢ v4.2.0 ‚Ä¢ Secure Enclave
		</div>
	</div>
	

    <div id="quiz" class="card hidden">
        <div class="progress-track">
            <div id="progress-fill" class="progress-fill"></div>
        </div>
        
        <div style="display:flex; justify-content:space-between; color:#64748b; font-size:0.8rem; text-transform:uppercase; letter-spacing:1px; margin-bottom:15px;">
            <span id="question-count">Q 1 / 30</span>
            <span id="question-category">Logic</span>
        </div>

        <h2 id="question-text" style="font-weight: 500;">Loading...</h2>
        
        <div id="options-container" class="options-grid"></div>
    </div>

    <div id="result-free" class="card hidden">
		<div style="color: #10b981; font-weight:700; letter-spacing:1px; font-size:0.85rem; margin-bottom:10px; background:#d1fae5; display:inline-block; padding:4px 12px; border-radius:20px;">
			‚úì CALCULATION COMPLETE
		</div>
		
		<h2 style="margin-top:5px;">Your Report is Ready</h2>
		<p style="font-size:0.95rem; color:#64748b;">The comprehensive analysis of your cognitive profile has been generated.</p>

		<div class="range-box-premium">
			<p style="margin:0; font-size: 0.75rem; text-transform: uppercase; letter-spacing: 1px; color: #64748b; font-weight:700;">Your Estimated IQ Range</p>
			<div id="calculated-range" style="font-size: 2.5rem; font-weight: 800; color: var(--primary); margin: 5px 0; letter-spacing: -1px;">Calculating...</div>
			<div style="height:4px; width:100%; background:#e2e8f0; border-radius:2px; margin:10px 0; position:relative;">
				<div style="position:absolute; left:20%; width:60%; height:100%; background:var(--accent); border-radius:2px; opacity:0.5;"></div>
			</div>
			<p id="range-desc" style="font-size: 0.9rem; color:#475569; margin:0;">Analysis based on standard deviation œÉ=15.</p>
		</div>

		<div class="premium-blur-container">
			<div class="fake-report-bg">
				<div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
					<div style="font-weight:bold; font-size:1.2rem;">IQ Global Report</div>
					<div style="font-size:0.8rem;">ID: 59102</div>
				</div>
				<div style="height:150px; background:#f1f5f9; border-radius:8px; margin-bottom:15px; display:flex; align-items:end; padding:10px; gap:10px;">
					<div style="height:40%; width:20%; background:#cbd5e1; border-radius:4px;"></div>
					<div style="height:70%; width:20%; background:#94a3b8; border-radius:4px;"></div>
					<div style="height:90%; width:20%; background:#3b82f6; border-radius:4px;"></div>
					<div style="height:60%; width:20%; background:#94a3b8; border-radius:4px;"></div>
				</div>
				<p>Detailed analysis of fluid intelligence indicates specific strengths in...</p>
				<p>Compared to the global population, the candidate ranks in the top...</p>
			</div>

			<div class="premium-overlay">
				<div class="lock-badge">üîí</div>
				<div class="premium-title">Unlock Full Report</div>
				<div class="premium-subtitle">Get immediate access to your certified results</div>
				
				<div class="benefit-list">
					<div class="benefit-item">
						<svg viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
						Precise IQ Score & Percentile
					</div>
					<div class="benefit-item">
						<svg viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
						Weakness & Strength Analysis
					</div>
					<div class="benefit-item">
						<svg viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
						Downloadable PDF Certificate
					</div>
				</div>
			</div>
		</div>
		
		<div id="paypal-button-container" style="margin: 20px auto; max-width: 100%; width: 300px;"></div>
		
		<p style="font-size: 0.75rem; color: #94a3b8; margin-top:10px;">
			<span style="display:inline-block; vertical-align:middle; width:6px; height:6px; background:#10b981; border-radius:50%; margin-right:4px;"></span>
			Secure SSL Payment ‚Ä¢ Instant Delivery
		</p>

		<button onclick="unlockResult()" class="admin-btn">[ADMIN] Bypass</button>
	</div>

    <div id="result-paid" class="card hidden">
        <div style="background: #dcfce7; color: #166534; padding: 10px; border-radius: 8px; display:inline-block; font-weight:600; font-size:0.9rem; margin-bottom:20px;">Payment Confirmed</div>
        
        <h2>Official Result</h2>
        <div class="iq-badge-large" id="final-score">---</div>
        <p style="font-size: 1.2rem;">Classification: <strong id="final-classification">---</strong></p>
        
        <div style="text-align: left; margin-top: 40px; background: #f8fafc; padding: 20px; border-radius: 10px;">
            <h4 style="margin-top:0;">Performance Breakdown:</h4>
            <div class="category-score"><span>Numerical Reasoning</span><strong id="score-numerical">---</strong></div>
            <div class="category-score"><span>Logical Patterns</span><strong id="score-logic">---</strong></div>
            <div class="category-score"><span>Verbal Analogies</span><strong id="score-verbal">---</strong></div>
        </div>

        <button class="btn" onclick="generateProfessionalPDF()">Download Professional Report (PDF)</button>
    </div>

	<div class="footer-legal">
        <a href="privacy.html" target="_blank">Privacy Policy</a> | 
        <a href="terms.html" target="_blank">Terms of Service</a>
    </div>
	
    <script>
        const questions = [
			// --- PART 1: MATH & NUMERICAL (10 Questions - TEXT ONLY) ---
			{ 
				text: "If 3 pencils cost $45, how much do 5 pencils cost?", 
				options: ["$60", "$55", "$75", "$80", "$95", "$65"], 
				correct: 2, cat: "Math" 
			},
			{ 
				text: "What is 15% of 200?", 
				options: ["20", "45", "30", "35", "15", "25"], 
				correct: 2, cat: "Math" 
			},
			{ 
				text: "1/2 of 1/2 of 1/2 of 80 is...", 
				options: ["5", "10", "20", "40", "2.5", "15"], 
				correct: 1, cat: "Math" 
			},
			{ 
				text: "0.5 x 0.5 = ?", 
				options: ["0.25", "1", "0.5", "0.05", "2.5", "0.025"], 
				correct: 0, cat: "Math" 
			},
			{ 
				text: "A car travels 60 miles in 1.5 hours. What is the speed?", 
				options: ["30 mph", "40 mph", "45 mph", "90 mph", "50 mph", "55 mph"], 
				correct: 1, cat: "Math" 
			},
			{ 
				text: "Which number is the odd one out? 4, 9, 16, 25, 30, 36", 
				options: ["4", "16", "25", "30", "9", "36"], 
				correct: 3, cat: "Math" 
			},
			{ 
				text: "If it takes 5 machines 5 min to make 5 widgets, how long for 100 machines for 100 widgets?", 
				options: ["100 min", "5 min", "1 hour", "50 min", "20 min", "500 min"], 
				correct: 1, cat: "Math" 
			},
			{ 
				text: "A bat and a ball cost $1.10. The bat costs $1 more than the ball. Ball cost?", 
				options: ["$0.10", "$0.05", "$0.01", "$0.50", "$0.09", "$0.20"], 
				correct: 1, cat: "Math" 
			},
			{ 
				text: "What is the square root of 144?", 
				options: ["10", "11", "12", "14", "16", "13"], 
				correct: 2, cat: "Math" 
			},
			{ 
				text: "Sequence: 2, 5, 11, 23... What comes next?", 
				options: ["47", "46", "45", "44", "48", "51"], 
				correct: 0, cat: "Math" 
			},

			// --- PART 2: VERBAL & ANALOGIES (10 Questions - TEXT ONLY) ---
			{ 
				text: "Finger is to Hand as Leaf is to...", 
				options: ["Tree", "Branch", "Root", "Forest", "Trunk", "Flower"], 
				correct: 1, cat: "Verbal" 
			},
			{ 
				text: "Opposite of 'Expand'?", 
				options: ["Shrink", "Grow", "Increase", "Stretch", "Widen", "Contract"], 
				correct: 5, cat: "Verbal" 
			},
			{ 
				text: "Doctor is to Hospital as Teacher is to...", 
				options: ["Student", "School", "Class", "Book", "Principal", "Library"], 
				correct: 1, cat: "Verbal" 
			},
			{ 
				text: "Synonym of 'Furious'?", 
				options: ["Happy", "Angry", "Calm", "Sad", "Annoyed", "Joyful"], 
				correct: 1, cat: "Verbal" 
			},
			{ 
				text: "Water is to Ice as Milk is to...", 
				options: ["Cow", "Cheese", "White", "Liquid", "Yogurt", "Cream"], 
				correct: 1, cat: "Verbal" 
			},
			{ 
				text: "Which word does not belong?", 
				options: ["Apple", "Banana", "Carrot", "Grape", "Orange", "Mango"], 
				correct: 2, cat: "Verbal" 
			},
			{ 
				text: "Unscramble: LBAFOTOL is a...", 
				options: ["City", "Sport", "Animal", "Food", "Country", "Object"], 
				correct: 1, cat: "Verbal" 
			},
			{ 
				text: "Brave is to Cowardly as Happy is to...", 
				options: ["Smile", "Sad", "Laugh", "Cry", "Miserable", "Joy"], 
				correct: 4, cat: "Verbal" 
			},
			{ 
				text: "Electricity is to Wire as Water is to...", 
				options: ["Bottle", "River", "Pipe", "Rain", "Glass", "Bucket"], 
				correct: 2, cat: "Verbal" 
			},
			{ 
				text: "Which word is spelled correctly?", 
				options: ["Neccessary", "Necessary", "Necesary", "Neccesary", "Nesessary", "Neccecary"], 
				correct: 1, cat: "Verbal" 
			},

			// --- PART 3: VISUAL LOGIC (10 Questions - SVG STYLED & FIXED) ---
			{ 
				text: "Which shape completes the sequence?", 
				image: `<svg width="400" height="120" viewBox="0 0 200 60"><circle cx="30" cy="30" r="20" stroke="black" stroke-width="3" fill="none" /><path d="M55 30 L65 30" stroke="black" stroke-width="2" marker-end="url(#arrow)" /><circle cx="90" cy="30" r="20" stroke="black" stroke-width="3" fill="none" /><path d="M90 10 A20 20 0 0 1 90 50 Z" fill="black" /><path d="M115 30 L125 30" stroke="black" stroke-width="2" marker-end="url(#arrow)" /><text x="150" y="40" font-family="Arial, sans-serif" font-weight="bold" font-size="40">?</text></svg>`,
				options: [
					`<svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="20" stroke="black" fill="none" stroke-width="3"/></svg>`, 
					`<svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="20" stroke="black" fill="black"/></svg>`, 
					`<svg viewBox="0 0 50 50"><rect x="5" y="5" width="40" height="40" stroke="black" fill="none" stroke-width="3"/></svg>`, 
					`<svg viewBox="0 0 50 50"><line x1="5" y1="25" x2="45" y2="25" stroke="black" stroke-width="3"/></svg>`, 
					`<svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="5" fill="black"/></svg>`, 
					`<svg viewBox="0 0 50 50"><path d="M10 10 L40 40 M40 10 L10 40" stroke="black" stroke-width="3"/></svg>` 
				], 
				correct: 1, cat: "Logic" 
			},
			{ 
				text: "Select the missing segment (Rotation):", 
				image: `<svg width="400" height="120" viewBox="0 0 240 60"><g transform="translate(30,30)"><line x1="0" y1="0" x2="0" y2="-20" stroke="black" stroke-width="4"/><circle cx="0" cy="0" r="22" stroke="black" fill="none"/></g><g transform="translate(90,30)"><line x1="0" y1="0" x2="20" y2="0" stroke="black" stroke-width="4"/><circle cx="0" cy="0" r="22" stroke="black" fill="none"/></g><g transform="translate(150,30)"><line x1="0" y1="0" x2="0" y2="20" stroke="black" stroke-width="4"/><circle cx="0" cy="0" r="22" stroke="black" fill="none"/></g><text x="200" y="40" font-family="Arial, sans-serif" font-weight="bold" font-size="40">?</text></svg>`,
				options: [
					`<svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="22" stroke="black" fill="none"/><line x1="25" y1="25" x2="25" y2="5" stroke="black" stroke-width="4"/></svg>`, 
					`<svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="22" stroke="black" fill="none"/><line x1="25" y1="25" x2="45" y2="25" stroke="black" stroke-width="4"/></svg>`, 
					`<svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="22" stroke="black" fill="none"/><line x1="25" y1="25" x2="25" y2="45" stroke="black" stroke-width="4"/></svg>`, 
					`<svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="22" stroke="black" fill="none"/><line x1="25" y1="25" x2="5" y2="25" stroke="black" stroke-width="4"/></svg>`, 
					`<svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="22" stroke="black" fill="none"/><circle cx="25" cy="25" r="5" fill="black"/></svg>`, 
					`<svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="22" stroke="black" fill="none"/><line x1="10" y1="10" x2="40" y2="40" stroke="black" stroke-width="4"/></svg>` 
				], 
				correct: 3, cat: "Logic" 
			},
			{ 
				text: "How many squares?", 
				image: `<svg width="400" height="120" viewBox="0 0 200 60"><rect x="10" y="20" width="20" height="20" stroke="black" fill="none" stroke-width="2"/><rect x="60" y="20" width="20" height="20" stroke="black" fill="none" stroke-width="2"/><rect x="70" y="20" width="20" height="20" stroke="black" fill="none" stroke-width="2"/><text x="140" y="40" font-family="Arial, sans-serif" font-weight="bold" font-size="40">?</text></svg>`,
				options: [
					`<svg viewBox="0 0 50 50"><rect x="15" y="15" width="20" height="20" stroke="black" fill="none" stroke-width="2"/></svg>`, 
					`<svg viewBox="0 0 50 50"><rect x="10" y="15" width="20" height="20" stroke="black" fill="none" stroke-width="2"/><rect x="20" y="15" width="20" height="20" stroke="black" fill="none" stroke-width="2"/></svg>`, 
					`<svg viewBox="0 0 50 50"><rect x="5" y="15" width="20" height="20" stroke="black" fill="none" stroke-width="2"/><rect x="15" y="15" width="20" height="20" stroke="black" fill="none" stroke-width="2"/><rect x="25" y="15" width="20" height="20" stroke="black" fill="none" stroke-width="2"/></svg>`, 
					`<svg viewBox="0 0 50 50"><text x="25" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-weight="bold" font-size="30">4</text></svg>`, 
					`<svg viewBox="0 0 50 50"><text x="25" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-weight="bold" font-size="30">5</text></svg>`, 
					`<svg viewBox="0 0 50 50"><text x="25" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-weight="bold" font-size="30">0</text></svg>` 
				], 
				correct: 3, cat: "Logic" 
			},
			{ 
				text: "Matrix Completion (X / O):", 
				image: `<svg width="300" height="300" viewBox="0 0 100 100"><rect x="0" y="0" width="30" height="30" fill="#ddd"/><text x="10" y="20" font-family="Arial, sans-serif" font-weight="bold">X</text><rect x="35" y="0" width="30" height="30" fill="#ddd"/><text x="45" y="20" font-family="Arial, sans-serif" font-weight="bold">O</text><rect x="70" y="0" width="30" height="30" fill="#ddd"/><text x="80" y="20" font-family="Arial, sans-serif" font-weight="bold">X</text><rect x="0" y="35" width="30" height="30" fill="#ddd"/><text x="10" y="55" font-family="Arial, sans-serif" font-weight="bold">O</text><rect x="35" y="35" width="30" height="30" fill="#ddd"/><text x="45" y="55" font-family="Arial, sans-serif" font-weight="bold">X</text><rect x="70" y="35" width="30" height="30" fill="#ddd"/><text x="80" y="55" font-family="Arial, sans-serif" font-weight="bold">O</text><rect x="0" y="70" width="30" height="30" fill="#ddd"/><text x="10" y="90" font-family="Arial, sans-serif" font-weight="bold">X</text><rect x="35" y="70" width="30" height="30" fill="#ddd"/><text x="45" y="90" font-family="Arial, sans-serif" font-weight="bold">O</text><rect x="70" y="70" width="30" height="30" fill="white" stroke="black"/><text x="80" y="90" font-family="Arial, sans-serif" font-weight="bold">?</text></svg>`,
				options: [
					`<svg viewBox="0 0 50 50"><text x="25" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-weight="bold" font-size="30">O</text></svg>`, 
					`<svg viewBox="0 0 50 50"><text x="25" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-weight="bold" font-size="30">X</text></svg>`, 
					`<svg viewBox="0 0 50 50"><text x="25" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-weight="bold" font-size="30">Y</text></svg>`, 
					`<svg viewBox="0 0 50 50"><rect x="10" y="10" width="30" height="30" stroke="black" fill="none"/></svg>`, 
					`<svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="15" stroke="black" fill="none"/></svg>`, 
					`<svg viewBox="0 0 50 50"><polygon points="25,10 40,40 10,40" stroke="black" fill="none"/></svg>` 
				], 
				correct: 1, cat: "Logic" 
			},
			{ 
				text: "Shape arithmetic: | + - = ?", 
				image: `<svg width="400" height="120" viewBox="0 0 200 60"><line x1="20" y1="10" x2="20" y2="50" stroke="black" stroke-width="4" /><text x="50" y="40" font-family="Arial, sans-serif" font-weight="bold" font-size="30">+</text><line x1="80" y1="30" x2="120" y2="30" stroke="black" stroke-width="4" /><text x="140" y="40" font-family="Arial, sans-serif" font-weight="bold" font-size="30">=</text><text x="170" y="40" font-family="Arial, sans-serif" font-weight="bold" font-size="40">?</text></svg>`,
				options: [
					`<svg viewBox="0 0 50 50"><line x1="10" y1="25" x2="40" y2="25" stroke="black" stroke-width="4"/></svg>`, 
					`<svg viewBox="0 0 50 50"><line x1="25" y1="10" x2="25" y2="40" stroke="black" stroke-width="4"/></svg>`, 
					`<svg viewBox="0 0 50 50"><path d="M25 10 L25 40 M10 25 L40 25" stroke="black" stroke-width="4"/></svg>`, 
					`<svg viewBox="0 0 50 50"><path d="M10 10 L40 40 M40 10 L10 40" stroke="black" stroke-width="4"/></svg>`, 
					`<svg viewBox="0 0 50 50"><path d="M10 20 L40 20 M10 30 L40 30" stroke="black" stroke-width="4"/></svg>`, 
					`<svg viewBox="0 0 50 50"><line x1="10" y1="40" x2="40" y2="10" stroke="black" stroke-width="4"/></svg>` 
				], 
				correct: 2, cat: "Logic" 
			},
			{ 
				text: "Sequence by sides: Triangle, Square, Pentagon, ?", 
				image: `<svg width="400" height="100" viewBox="0 0 240 60"><polygon points="20,50 40,10 60,50" stroke="black" fill="none" stroke-width="2"/><rect x="80" y="15" width="35" height="35" stroke="black" fill="none" stroke-width="2"/><polygon points="140,50 170,50 180,30 155,10 130,30" stroke="black" fill="none" stroke-width="2"/><text x="200" y="40" font-family="Arial, sans-serif" font-weight="bold" font-size="40">?</text></svg>`,
				options: [
					`<svg viewBox="0 0 50 50"><polygon points="25,5 45,45 5,45" stroke="black" fill="none" stroke-width="2"/></svg>`, 
					`<svg viewBox="0 0 50 50"><rect x="10" y="10" width="30" height="30" stroke="black" fill="none" stroke-width="2"/></svg>`, 
					`<svg viewBox="0 0 50 50"><polygon points="15,5 35,5 45,25 35,45 15,45 5,25" stroke="black" fill="none" stroke-width="2"/></svg>`, 
					`<svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="20" stroke="black" fill="none" stroke-width="2"/></svg>`, 
					`<svg viewBox="0 0 50 50"><line x1="10" y1="25" x2="40" y2="25" stroke="black" stroke-width="2"/></svg>`, 
					`<svg viewBox="0 0 50 50"><polygon points="25,5 30,20 45,20 35,30 40,45 25,35 10,45 15,30 5,20 20,20" stroke="black" fill="none"/></svg>` 
				], 
				correct: 2, cat: "Logic" 
			},
			{ 
				text: "Subtraction: Full Dot - Inner Dot = ?", 
				image: `<svg width="400" height="120" viewBox="0 0 200 60"><g><circle cx="30" cy="30" r="20" stroke="black" fill="none" stroke-width="2"/><circle cx="30" cy="30" r="5" fill="black"/></g><text x="60" y="35" font-family="Arial, sans-serif" font-weight="bold" font-size="20">-</text><circle cx="90" cy="30" r="5" fill="black"/><text x="110" y="35" font-family="Arial, sans-serif" font-weight="bold" font-size="20">=</text><text x="140" y="40" font-family="Arial, sans-serif" font-weight="bold" font-size="40">?</text></svg>`,
				options: [
					`<svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="5" fill="black"/></svg>`, 
					`<svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="20" stroke="black" fill="none" stroke-width="2"/></svg>`, 
					`<svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="20" fill="black"/></svg>`, 
					`<svg viewBox="0 0 50 50"><rect x="10" y="10" width="30" height="30" stroke="black" fill="none"/></svg>`, 
					`<svg viewBox="0 0 50 50"><text x="25" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-weight="bold">0</text></svg>`, 
					`<svg viewBox="0 0 50 50"><line x1="10" y1="25" x2="40" y2="25" stroke="black"/></svg>` 
				], 
				correct: 1, cat: "Logic" 
			},
			{ 
				text: "Analogy: Arrow -> Target :: Ball -> ?", 
				image: `<svg width="400" height="120" viewBox="0 0 200 60"><path d="M10 30 L40 30 M35 25 L40 30 L35 35" stroke="black" stroke-width="2"/><circle cx="70" cy="30" r="15" stroke="black" fill="none"/> <circle cx="70" cy="30" r="5" fill="black"/><line x1="95" y1="10" x2="95" y2="50" stroke="black"/><circle cx="120" cy="30" r="10" fill="black"/><text x="150" y="40" font-family="Arial, sans-serif" font-weight="bold" font-size="40">?</text></svg>`,
				options: [
					`<svg viewBox="0 0 50 50"><path d="M10 40 Q25 10 40 40" stroke="black" fill="none" stroke-width="2"/></svg>`, 
					`<svg viewBox="0 0 50 50"><rect x="5" y="10" width="40" height="30" stroke="black" fill="none"/><line x1="5" y1="10" x2="45" y2="40" stroke="black"/><line x1="45" y1="10" x2="5" y2="40" stroke="black"/></svg>`, 
					`<svg viewBox="0 0 50 50"><path d="M15 40 L15 20 L10 10 L20 10 L25 20 L30 10 L40 10 L35 20 L35 40 Z" stroke="black" fill="none"/></svg>`, 
					`<svg viewBox="0 0 50 50"><path d="M0 40 L10 30 L20 40 L30 30 L40 40" stroke="black" fill="none"/></svg>`, 
					`<svg viewBox="0 0 50 50"><circle cx="40" cy="10" r="5" stroke="black" fill="none"/><path d="M10 40 Q25 30 40 40" stroke="black" fill="none"/></svg>`, 
					`<svg viewBox="0 0 50 50"><path d="M10 30 L30 30 L40 40 L10 40 Z" stroke="black" fill="none"/></svg>` 
				], 
				correct: 1, cat: "Logic" 
			},
			{
				text: "Clock Logic: 12 -> 3 -> 6 -> ?",
				image: `<svg width="400" height="120" viewBox="0 0 200 60"><circle cx="20" cy="30" r="15" fill="none" stroke="black"/><line x1="20" y1="30" x2="20" y2="15" stroke="black" stroke-width="2"/><circle cx="60" cy="30" r="15" fill="none" stroke="black"/><line x1="60" y1="30" x2="75" y2="30" stroke="black" stroke-width="2"/><circle cx="100" cy="30" r="15" fill="none" stroke="black"/><line x1="100" y1="30" x2="100" y2="45" stroke="black" stroke-width="2"/><text x="140" y="40" font-family="Arial, sans-serif" font-weight="bold" font-size="40">?</text></svg>`,
				options: [
					`<svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="20" fill="none" stroke="black"/><line x1="25" y1="25" x2="5" y2="25" stroke="black" stroke-width="2"/></svg>`, 
					`<svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="20" fill="none" stroke="black"/><line x1="25" y1="25" x2="25" y2="5" stroke="black" stroke-width="2"/></svg>`, 
					`<svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="20" fill="none" stroke="black"/><line x1="25" y1="25" x2="35" y2="40" stroke="black" stroke-width="2"/></svg>`, 
					`<svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="20" fill="none" stroke="black"/><line x1="25" y1="25" x2="35" y2="10" stroke="black" stroke-width="2"/></svg>`, 
					`<svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="20" fill="none" stroke="black"/><line x1="25" y1="25" x2="10" y2="10" stroke="black" stroke-width="2"/></svg>`, 
					`<svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="20" fill="none" stroke="black"/><line x1="25" y1="25" x2="15" y2="40" stroke="black" stroke-width="2"/></svg>`  
				],
				correct: 0, cat: "Logic"
			},
			{
				text: "Growth Pattern: Small -> Medium -> Big -> ?",
				image: `<svg width="400" height="120" viewBox="0 0 200 60"><rect x="10" y="40" width="10" height="10" fill="black"/><rect x="40" y="30" width="10" height="20" fill="black"/><rect x="70" y="20" width="10" height="30" fill="black"/><text x="110" y="40" font-family="Arial, sans-serif" font-weight="bold" font-size="40">?</text></svg>`,
				options: [
					`<svg viewBox="0 0 50 50"><rect x="20" y="20" width="10" height="10" fill="black"/></svg>`, 
					`<svg viewBox="0 0 50 50"><rect x="20" y="10" width="10" height="30" fill="black"/></svg>`, 
					`<svg viewBox="0 0 50 50"><rect x="20" y="5" width="10" height="40" fill="black"/></svg>`, 
					`<svg viewBox="0 0 50 50"><rect x="5" y="5" width="40" height="40" stroke="black" fill="none"/></svg>`, 
					`<svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="10" fill="black"/></svg>`, 
					`<svg viewBox="0 0 50 50"><rect x="10" y="20" width="30" height="5" fill="black"/></svg>` 
				],
				correct: 2, cat: "Logic"
			}
		];

        let state = {
			currentQ: 0,
			score: 0,
			userAnswers: [],
			
			catScores: { Logic: 0, Math: 0, Verbal: 0 }, 
			catTotals: { Logic: 0, Math: 0, Verbal: 0 },
			timeLeft: 1200,
			timerId: null,
			iq: 0
		};

        // Calcoliamo i totali per categoria all'avvio
        questions.forEach(q => {
            if(!state.catTotals[q.cat]) state.catTotals[q.cat] = 0;
            state.catTotals[q.cat]++;
        });

        // --- CORE FUNCTIONS ---

        function startTest() {
            document.getElementById('intro').classList.add('hidden');
            document.getElementById('quiz').classList.remove('hidden');
            document.getElementById('timer-badge').style.display = 'block';
            state.timerId = setInterval(updateTimer, 1000);
            renderQuestion();
        }

        function updateTimer() {
            state.timeLeft--;
            let m = Math.floor(state.timeLeft / 60);
            let s = state.timeLeft % 60;
            document.getElementById('timer-badge').innerText = `${m}:${s < 10 ? '0'+s : s}`;
            if (state.timeLeft <= 0) finishTest();
        }

        function renderQuestion() {
			const q = questions[state.currentQ];
			document.getElementById('question-count').innerText = `Q ${state.currentQ + 1} / ${questions.length}`;
			document.getElementById('question-category').innerText = q.cat.toUpperCase() + " REASONING";
			
			// GESTIONE DOMANDA PRINCIPALE
			const qTextElement = document.getElementById('question-text');
			qTextElement.innerHTML = ""; 

			if (q.image) {
				// Mostra il disegno della domanda (SVG)
				const imgContainer = document.createElement('div');
				imgContainer.style.textAlign = "center";
				imgContainer.style.marginBottom = "20px";
				imgContainer.innerHTML = q.image; 
				qTextElement.appendChild(imgContainer);
				
				// Testo opzionale sotto l'immagine
				const textNode = document.createElement('div');
				textNode.innerText = q.text;
				textNode.style.fontSize = "1.2rem";
				qTextElement.appendChild(textNode);
			} else {
				qTextElement.innerText = q.text;
			}
			
			// Barra progresso
			const pct = ((state.currentQ) / questions.length) * 100;
			document.getElementById('progress-fill').style.width = pct + '%';

			// GESTIONE RISPOSTE (OPTIONS)
			const container = document.getElementById('options-container');
			container.innerHTML = '';
			
			const letters = ["A", "B", "C", "D", "E", "F"]; // Etichette automatiche

			q.options.forEach((optContent, idx) => {
				const div = document.createElement('div');
				div.className = 'option-card';
				div.onclick = () => handleAnswer(idx);
				
				let innerHTML = "";
				
				// SE √à LOGICA: optContent √® un codice SVG -> Lo renderizziamo come HTML
				if(q.cat === "Logic") {
					 innerHTML = `
						<div class="option-svg-container">${optContent}</div>
						<div class="option-label">${letters[idx]}</div>
					 `;
				} 
				// SE √à ALTRO (Math/Verbal): optContent √® testo -> Lo mostriamo come testo
				else {
					 innerHTML = `<div style="display:flex; align-items:center; width:100%; padding:10px;"><div class="option-circle"></div> <span style="font-size:1.1rem">${optContent}</span></div>`;
					 div.style.alignItems = "flex-start"; 
					 div.style.textAlign = "left";
					 div.style.minHeight = "auto"; // Meno altezza per testo
				}
			   
				div.innerHTML = innerHTML;
				container.appendChild(div);
			});
		}
		
        function handleAnswer(idx) {
			// 1. Salviamo la risposta dell'utente nell'array
			state.userAnswers[state.currentQ] = idx;

			const q = questions[state.currentQ];
			
			// 2. Controllo correttezza (come prima)
			if (idx === q.correct) {
				state.score++;
				state.catScores[q.cat]++;
			}
			
			// 3. Avanzamento
			state.currentQ++;
			if (state.currentQ < questions.length) renderQuestion();
			else finishTest();
		}

        function finishTest() {
			clearInterval(state.timerId);
			document.getElementById('quiz').classList.add('hidden');
			document.getElementById('timer-badge').style.display = 'none';
			document.getElementById('result-free').classList.remove('hidden');

			// Calcolo QI con il boost di +10 che hai chiesto prima (Base 85 invece di 75)
			state.iq = 85 + Math.round((state.score / questions.length) * 70); 
			
			// MODIFICA QUI: Range molto pi√π ampio (+/- 15 punti)
			// Esempio: Se IQ √® 100 -> Mostra "85 - 115"
			let minRange = state.iq - 15;
			let maxRange = state.iq + 15;
			
			document.getElementById('calculated-range').innerText = `${minRange} - ${maxRange}`;
			
			// Descrizione generica basata sul range alto
			let desc = "Average logic capability.";
			if(maxRange > 120) desc = "Potential for high analytical intelligence detected.";
			if(maxRange > 135) desc = "Exceptional cognitive processing potential.";
			document.getElementById('range-desc').innerText = desc;
		}

        function unlockResult() {
            document.getElementById('result-free').classList.add('hidden');
            document.getElementById('result-paid').classList.remove('hidden');
            
            document.getElementById('final-score').innerText = state.iq;
            
            let label = "Average";
            if(state.iq >= 115) label = "Above Average";
            if(state.iq >= 130) label = "Gifted / Superior";
            document.getElementById('final-classification').innerText = label;

            // Mostra breakdown HTML
            document.getElementById('score-numerical').innerText = `${state.catScores.Math} / ${state.catTotals.Math}`;
            document.getElementById('score-logic').innerText = `${state.catScores.Logic} / ${state.catTotals.Logic}`;
            document.getElementById('score-verbal').innerText = `${state.catScores.Verbal} / ${state.catTotals.Verbal}`;
        }

        // --- MOTORE PDF PROFESSIONALE ---
		function generateProfessionalPDF() {
			try {
				if (!window.jspdf) {
					alert("Errore: Libreria PDF non caricata. Ricarica la pagina.");
					return;
				}

				const { jsPDF } = window.jspdf;
				// Crea documento A4 standard
				const doc = new jsPDF('p', 'mm', 'a4');
				const width = doc.internal.pageSize.getWidth(); // 210mm
				const height = doc.internal.pageSize.getHeight(); // 297mm
				const margin = 20;

				// --- PAGINA 1: OVERVIEW --- //

				// 1. HEADER (Sfondo Bianco e Linea Sottile)
				const headerH = 30; // Ridotto da 40 a 30
				doc.setFillColor(255, 255, 255); 
				doc.rect(0, 0, width, headerH, 'F');
				doc.setDrawColor(230, 230, 230);
				doc.setLineWidth(0.5);
				doc.line(0, headerH, width, headerH);

				// --- DISEGNO LOGO VETTORIALE (Ridimensionato) ---
				const logoSize = 10; // Ridotto da 14 a 10
				const logoX = margin;
				const logoY = 10; // Posizione Y
				
				// Sfondo Icona
				doc.setFillColor(37, 99, 235); // Blu
				doc.roundedRect(logoX, logoY, logoSize, logoSize, 2, 2, 'F');
				
				// Pallini e Linee (Scala adattata al nuovo size)
				doc.setDrawColor(255, 255, 255);
				doc.setFillColor(255, 255, 255);
				doc.setLineWidth(0.6);
				
				// Coordinate relative dentro il logo 10x10
				doc.line(logoX + 5, logoY + 3, logoX + 3, logoY + 7); 
				doc.line(logoX + 5, logoY + 3, logoX + 7, logoY + 7); 
				doc.line(logoX + 3, logoY + 7, logoX + 7, logoY + 7); 
				
				doc.circle(logoX + 5, logoY + 3, 0.8, 'F');  
				doc.circle(logoX + 3, logoY + 7, 0.8, 'F'); 
				doc.circle(logoX + 7, logoY + 7, 0.8, 'F'); 

				// Testo Brand (Pi√π piccolo ed elegante)
				doc.setFont("helvetica", "bold");
				doc.setFontSize(16); // Ridotto da 22
				doc.setTextColor(15, 23, 42); 
				doc.text("IQ METRICS", margin + 14, logoY + 7);
				
				doc.setFont("helvetica", "normal");
				doc.setTextColor(100, 116, 139); 
				doc.text("GLOBAL", margin + 52, logoY + 7); 

				// Sottotitolo
				doc.setFontSize(7); // Ridotto da 9
				doc.setTextColor(148, 163, 184);
				doc.text("CERTIFIED COGNITIVE ASSESSMENT", margin + 14, logoY + 11); // Allineato sotto

				// ID Badge (Molto pi√π discreto)
				doc.setFillColor(248, 250, 252);
				doc.setDrawColor(226, 232, 240);
				doc.roundedRect(width - margin - 35, logoY + 1, 35, 8, 4, 4, 'FD'); // Pi√π piccolo
				doc.setFontSize(8);
				doc.setTextColor(71, 85, 105);
				doc.text("ID: " + Math.floor(Math.random()*100000), width - margin - 17.5, logoY + 6, null, null, "center");

				// 2. BOX PUNTEGGIO
				const scoreY = 50; // Alzato un po'
				doc.setTextColor(15, 23, 42);
				doc.setFontSize(10); // Ridotto
				doc.setFont("helvetica", "bold");
				doc.text("CANDIDATE RESULT", 105, scoreY, null, null, "center");
				
				doc.setFontSize(50); // Ridotto da 60 a 50
				doc.setTextColor(37, 99, 235); 
				doc.text(String(state.iq), 105, scoreY + 18, null, null, "center");
				
				doc.setFontSize(12); // Ridotto
				doc.setTextColor(71, 85, 105);
				doc.setFont("helvetica", "normal");
				let classText = "Average Intelligence";
				if(state.iq > 115) classText = "High Intelligence";
				if(state.iq > 130) classText = "Superior / Gifted";
				doc.text(classText, 105, scoreY + 26, null, null, "center");

				// Linea separatrice sottile
				doc.setDrawColor(226, 232, 240);
				doc.setLineWidth(0.5);
				doc.line(margin, scoreY + 35, width - margin, scoreY + 35);

				// === 3. GRAFICO GAUSSIANO ===
				const graphY = scoreY + 45;
				const graphH = 60; // Altezza contenuta
				
				// Sfondo Grafico
				doc.setFillColor(250, 250, 250); 
				doc.setDrawColor(230, 230, 230); 
				doc.rect(margin, graphY, width - (margin * 2), graphH, 'FD');

				doc.setTextColor(15, 23, 42);
				doc.setFontSize(9);
				doc.setFont("helvetica", "bold");
				doc.text("GLOBAL IQ DISTRIBUTION", margin + 10, graphY + 10);
				doc.setFont("helvetica", "normal");
				doc.setFontSize(7);
				doc.setTextColor(100, 116, 139);
				doc.text("(Mean=100, SD=15)", margin + 10, graphY + 14);

				const gBaseY = graphY + 45; 
				const gStartX = margin + 10;
				const gWidth = width - (margin * 2) - 20;
				const gMaxH = 30; 

				// Disegno curva
				doc.setDrawColor(59, 130, 246); 
				doc.setLineWidth(0.8);

				for(let i = 0; i <= 100; i++) {
					const sd = -3.5 + (i / 100) * 7; 
					const yVal = Math.exp(-0.5 * sd * sd); 
					const px = gStartX + (i / 100) * gWidth;
					const py = gBaseY - (yVal * gMaxH);
					if(i === 0) doc.moveTo(px, py);
					else doc.lineTo(px, py);
				}
				doc.stroke();

				// Linea base
				doc.setDrawColor(148, 163, 184);
				doc.line(gStartX, gBaseY, gStartX + gWidth, gBaseY);

				// Marcatori
				const markers = [-2, -1, 0, 1, 2];
				markers.forEach(sd => {
					const iqVal = 100 + (sd * 15);
					const percentX = (sd - (-3.5)) / 7; 
					const lineX = gStartX + (percentX * gWidth);
					doc.setDrawColor(200, 200, 200);
					doc.setLineWidth(0.1);
					doc.line(lineX, gBaseY, lineX, gBaseY - (Math.exp(-0.5 * sd * sd) * gMaxH));
					doc.setFontSize(6);
					doc.setTextColor(150, 150, 150);
					doc.text(String(iqVal), lineX, gBaseY + 4, null, null, "center");
				});

				// YOU Marker
				const userSD = (state.iq - 100) / 15;
				const clampedSD = Math.max(-3.4, Math.min(3.4, userSD)); 
				const userX = gStartX + ((clampedSD - (-3.5)) / 7) * gWidth;
				const curveHeightAtUser = Math.exp(-0.5 * clampedSD * clampedSD) * gMaxH;
				const lineStopY = gBaseY - curveHeightAtUser; 

				doc.setDrawColor(245, 158, 11); // Amber
				doc.setLineWidth(1.5);
				doc.line(userX, graphY + 20, userX, lineStopY - 1); 
				
				doc.setFillColor(245, 158, 11);
				doc.circle(userX, lineStopY, 1.5, 'F'); 

				// Etichetta YOU (Piccola)
				doc.setFontSize(7);
				doc.setTextColor(255, 255, 255); 
				doc.setFont("helvetica", "bold");
				doc.roundedRect(userX - 6, graphY + 16, 12, 4, 1, 1, 'F'); // Background arancione
				doc.text("YOU", userX, graphY + 19, null, null, "center");

				// 4. BREAKDOWN
				let yPos = graphY + graphH + 15;
				doc.setFontSize(11);
				doc.setTextColor(15, 23, 42);
				doc.text("Detailed Breakdown", margin, yPos);
				yPos += 8;
				doc.setFontSize(9);
				doc.setFont("helvetica", "normal");
				
				function drawBar(label, score, total, y) {
					doc.setTextColor(71, 85, 105);
					doc.text(label, margin, y);
					doc.text(`${score} / ${total}`, width - margin, y, null, null, "right");
					
					doc.setFillColor(241, 245, 249); 
					doc.roundedRect(70, y-3, 90, 3, 1, 1, 'F'); 
					if(total > 0) {
						doc.setFillColor(37, 99, 235);   
						doc.roundedRect(70, y-3, (score/total)*90, 3, 1, 1, 'F'); 
					}
				}

				drawBar("Numerical Reasoning:", state.catScores.Math, state.catTotals.Math, yPos);
				yPos += 8;
				drawBar("Logical Patterns:", state.catScores.Logic, state.catTotals.Logic, yPos);
				yPos += 8;
				drawBar("Verbal Analogies:", state.catScores.Verbal, state.catTotals.Verbal, yPos);

				// 5. ANALISI TESTUALE
				yPos += 18;
				doc.setFontSize(11);
				doc.setFont("helvetica", "bold");
				doc.setTextColor(15, 23, 42);
				doc.text("Cognitive Profile Analysis", margin, yPos);
				yPos += 6;
				doc.setFontSize(9); // Font pi√π piccolo per il testo lungo
				doc.setFont("helvetica", "normal");
				doc.setTextColor(71, 85, 105); 
				
				let analysisText = "";
				if(state.iq < 100) {
					analysisText = "The results suggest a practical learning style. While abstract logic tasks presented a challenge, the candidate likely performs better in hands-on, concrete problem-solving scenarios where experience can be applied directly.";
				} else if (state.iq < 120) {
					analysisText = "The candidate displays solid logical foundations. Strengths include the ability to follow complex instructions and solve standard problems effectively. Pattern recognition is within the upper-average range, showing good potential for analytical tasks.";
				} else {
					analysisText = "The candidate demonstrates exceptional cognitive efficiency. The results indicate a high capacity for abstract thinking, rapid pattern recognition, and the ability to grasp complex concepts quickly. This profile is often associated with high-level strategic planning capabilities.";
				}
				
				const splitText = doc.splitTextToSize(analysisText, width - (margin * 2));
				doc.text(splitText, margin, yPos);

				// --- PAGINA 2: ERRORI ---
				doc.addPage();
				
				// Header Pagina 2 minimale
				doc.setFillColor(248, 250, 252);
				doc.rect(0, 0, width, 15, 'F');
				doc.setFontSize(9);
				doc.setTextColor(100, 116, 139);
				doc.setFont("helvetica", "bold");
				doc.text("APPENDIX: ERROR ANALYSIS", margin, 10);

				yPos = 30;
				const letters = ["A", "B", "C", "D", "E", "F"];

				questions.forEach((q, index) => {
					const userAnsIdx = state.userAnswers[index];
					if (userAnsIdx !== q.correct) {
						if (yPos > height - 20) {
							doc.addPage();
							yPos = 30;
						}
						doc.setFontSize(9);
						doc.setTextColor(15, 23, 42);
						doc.setFont("helvetica", "bold");
						doc.text(`Q${index + 1} (${q.cat})`, margin, yPos);
						
						doc.setFont("helvetica", "normal");
						doc.setTextColor(100, 116, 139);
						// Taglia testo se troppo lungo
						let shortText = q.text.length > 85 ? q.text.substring(0, 85) + "..." : q.text;
						doc.text(shortText, margin + 20, yPos);

						yPos += 4;
						const userLetter = userAnsIdx !== undefined ? letters[userAnsIdx] : "-";
						const correctLetter = letters[q.correct];

						doc.setFontSize(8);
						doc.setTextColor(220, 38, 38); 
						doc.text(`You: ${userLetter}`, margin + 20, yPos);
						doc.setTextColor(22, 163, 74); 
						doc.text(`Correct: ${correctLetter}`, margin + 40, yPos);

						yPos += 8; 
						doc.setDrawColor(240, 240, 240);
						doc.line(margin, yPos - 4, width - margin, yPos - 4);
					}
				});

				if (state.score === questions.length) {
					doc.setFontSize(10);
					doc.setTextColor(22, 163, 74);
					doc.text("Perfect Score! No errors detected.", margin, 40);
				}

				// Footer finale
				doc.setFontSize(7);
				doc.setTextColor(150, 150, 150);
				doc.text("IQ Metrics Global - Confidential Report", width - margin, height - 10, null, null, "right");

				doc.save("Cognitive_Report_Detailed.pdf");

			} catch (err) {
				alert("Errore PDF: " + err.message);
				console.error(err);
			}
		}

        // --- PAYPAL ---
        paypal.Buttons({
            createOrder: function(data, actions) {
                return actions.order.create({
                    purchase_units: [{ amount: { value: '1.00' }, description: 'IQ Report' }]
                });
            },
            onApprove: function(data, actions) {
                return actions.order.capture().then(function(details) {
                    unlockResult();
                });
            }
        }).render('#paypal-button-container');

    </script>
</body>
</html>